<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CodeMaster Academy</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: silver;
      text-align: center;
    }

    header {
      background-color: white;
      padding: 20px;
    }

    .logo {
      width: 150px;
      height: auto;
    }

    h1 {
      color: black;
      margin-top: 40px;
      font-weight: bold;
      font-size:32px;
      text-shadow: 0 0 10px #00f, 0 0 20px rgb(214, 62, 214), 0 0 10px purple;
    }

    p {
      color: black;
      text-shadow: 0 0 10px rgb(214, 62, 214), 0 0 20px #00f, 0 0 10px purple;    
    }

    #form-section {
      margin-top: 30px;
    }

    input {
      margin: 5px;
      padding: 8px;
      border-radius: 5px;
      border: 1px solid #ccc;
    }

    button {
      margin: 10px;
      padding: 10px 20px;
      border: none;
      background-color: #333;
      color: white;
      border-radius: 5px;
      cursor: pointer;
    }

    ul {
      list-style-type: disc;
      padding-left: 40px;
      text-align: left;
      max-width: 600px;
      margin: 20px auto;
    }

    li {
      margin-bottom: 15px;
      background-color: #fff;
      padding: 10px;
      border-radius: 5px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
  </style>
</head>
<body>
  <header>
    <img src="logo.png" alt="Logo CodeMaster Academy" class="logo" id="logo">
  </header>

  <main>
    <h1>Welcome to CodeMaster Academy!</h1>
    <p>Start your experience with software right now!</p>

    <div id="form-section">
      <input id="task" type="text" placeholder="Enter Task">
      <input id="status" type="text" placeholder="Enter Status">
      <input id="deadline" type="text" placeholder="Enter Deadline">
      <button onclick="saveTask()">Save Task</button>
      <button onclick="location.reload()">Refresh</button>
      <div id="result"></div>
    </div>

    <div id="json-output"></div>
  </main>
<script>
      function saveTask() {
        const task = document.querySelector("#task").value;
        const status = document.querySelector("#status").value;
        const deadline = document.querySelector("#deadline").value;
        const result = document.querySelector("#result");

        if (!task || !status || !deadline) {
          alert("Please fill in all fields.");
          return;
        }

        const newTask = { task, status, deadline };

        fetch('http://localhost:3000/api/tasks', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(newTask)
        })
        .then(response => {
          const messages = {
            200: 'I saved it for you',
            400: 'Missing task data!',
            404: 'Endpoint not found!',
            500: 'Server error!'
          };

          const message = messages[response.status] || 'Unexpected error occurred';
          result.textContent = message;
          console.log(message);

          if (response.status === 200) return response.json();
          throw new Error(message);
        })
        .then(() => fetchTasks())
        .catch(() => {
          result.textContent = 'Connection error!';
          console.log('Connection error!');
        });

        document.querySelector("#task").value = "";
        document.querySelector("#status").value = "";
        document.querySelector("#deadline").value = "";
      }
</script>


  <script>
    console.log('%cThe page has been loaded.', 'color: green; font-weight: bold; font-size: 20px');

    const logo = document.getElementById("logo");
    if (logo.complete && logo.naturalHeight !== 0) {
      console.log('%cThe logo has been loaded successfully.', 'color:lightgreen; font-weight: bold; font-size:18px');
    } else {
      console.log('%cError: The logo failed to load.', 'color:red; font-weight: bold; font-size:25px');
    }

    function saveTask() {
      const task = document.querySelector("#task").value;
      const status = document.querySelector("#status").value;
      const deadline = document.querySelector("#deadline").value;

      if (task && status && deadline) {
        const newTask = { task, status, deadline };
  
        fetch('http://localhost:3000/api/tasks', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(newTask)
        })
        .then(res => {
          if (!res.ok) {
            console.log('Problem');
            return;
          }
          return res.json();
        })
        .then(data => {
          console.log('Task saved');
          document.querySelector("#result").textContent = "I saved it for you :)";
          fetchTasks();
        })
        .catch(error => {
          console.log(error);
        });

        document.querySelector("#task").value = "";
        document.querySelector("#status").value = "";
        document.querySelector("#deadline").value = "";
      } else {
        alert("Please fill in all fields.");
      }
    }

    function fetchTasks() {
      fetch('/api/tasks')
        .then(response => response.json())
        .then(data => {
          const output = document.getElementById('json-output');
          output.innerHTML = '';

          const list = document.createElement('ul');

          data.forEach(item => {
            const listItem = document.createElement('li');
            listItem.innerHTML = `
              <strong>üìù Task:</strong> ${item.task}<br>
              <strong>üìå Status:</strong> ${item.status}<br>
              <strong>‚è∞ Deadline:</strong> ${item.deadline}
            `;
            list.appendChild(listItem); 
          });
            output.appendChild(list);         
        });
      }
      fetchTasks(); // ‚Üê ≈ºeby dane pojawi≈Çy siƒô od razu po za≈Çadowaniu strony

  </script>
</body>
</html>




